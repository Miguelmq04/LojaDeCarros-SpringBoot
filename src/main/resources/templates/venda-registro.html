<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>Cadastro de vendas</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" 
              rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        <link th:href="@{/css/vendaCadastro.css}" rel="stylesheet">
    </head>
    <body>
        <ul class="nav nav-tabs bg-dark">
            <li class="nav-item dropdown bg">
                <a class="nav-link dropdown-toggle text-white" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Menu</a>
                <ul class="dropdown-menu dropdown-menu-dark">
                    <li><a class="dropdown-item" th:href="@{/home}">Voltar</a></li>
                    <li><a class="dropdown-item" href="#" id="btn-limpar">Limpar campos</a></li>
                </ul>
            </li>
        </ul>
        <header><h2>Registro de vendas</h2></header>
        <div class="container my-5">
            <div class="align-items-center">
                <div class="row">
                    <div class="col-md-4 mx-auto">
                        <section>
                            <form th:action="@{/vendas/salvar}" th:object="${vendas}" method="post" id="vendaForm">
                                <div class="mb-3">
                                    <label for="veiculo" class="form-label">Veículo:</label>
                                    <select class="form-select" name="veiculoSelecionado" id="veiculo">
                                        <option value="">Selecione o veículo</option>
                                        <option th:each="veiculo : ${veiculos}" 
                                                th:value="${veiculo.IdVeiculo}" 
                                                th:text="${veiculo.MarcaVeiculo} + ' - ' + ${veiculo.ModeloVeiculo}">
                                        </option>
                                    </select>
                                    <div th:if="${erroVeiculo}" class="text-danger mt-1" th:text="${erroVeiculo}"></div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="cliente" class="form-label">Cliente:</label>
                                    <select class="form-select" name="clienteSelecionado" id="cliente">
                                        <option value="">Selecione o cliente</option>
                                        <option th:each="cliente : ${clientes}" 
                                                th:value="${cliente.IdCliente}" 
                                                th:text="${cliente.NomeCliente}">
                                        </option>
                                    </select>
                                    <div th:if="${erroCliente}" class="text-danger mt-1" th:text="${erroCliente}"></div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="funcionario" class="form-label">Funcionário:</label>
                                    <select class="form-select" name="funcionarioSelecionado" id="funcionario">
                                        <option value="">Selecione o funcionário</option>
                                        <option th:each="funcionario : ${funcionarios}" 
                                                th:value="${funcionario.IdFuncionario}" 
                                                th:text="${funcionario.NomeFuncionario}">
                                        </option>
                                    </select>
                                    <div th:if="${erroFuncionario}" class="text-danger mt-1" th:text="${erroFuncionario}"></div>
                                </div>
                                
                                <div class="text-center">
                                    <button type="submit" class="btn btn-primary btn-customVenda mb-3">Registrar</button>
                                </div>
                                
                                <div th:if="${mensagemSucesso}" class="alert alert-success text-center" role="alert">
                                    <span th:text="${mensagemSucesso}"></span>
                                </div>
                                
                                <nav class="text-center">
                                    <a th:href="@{/vendas/lista}" class="btn btn-outline-primary">Tabela de vendas</a>
                                </nav>
                            </form>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const form = document.getElementById("vendaForm");
                
                const btnLimpar = document.getElementById("btn-limpar");
                if (btnLimpar) {
                    btnLimpar.addEventListener("click", (e) => {
                        e.preventDefault();
                        form.reset();
                    });
                }
            });
        </script>
    </body>
</html>